---
date: 2025-07-04 00:00:00 +0100
title: "Centreon : comment vérifier la disponibilité d'un site web et l'expiration d'un certificat TLS ?"
author: Matty
categories: [Centreon]
tags: [Linux, supervision, centreon, http, tls, ssl]
render_with_liquid: false
image:
    path: /images/cybersecurite_snmp/cyberseecurie_snmpv2-v3.jpeg
---

## I. Présentation

Dans cet article, nous allons apprendre à vérifier l'état d'un site web à l'aide de la solution de supervision Centreon. Nous allons surveiller deux métriques essentielles : le code de réponse HTTP et la validité du certificat TLS / SSL. Ce type de contrôle est indispensable pour garantir la disponibilité et la sécurité de services web.

Nous utiliserons le Monitoring Connector HTTP Server de Centreon. Ce connecteur fournit un host template nommé `App-Protocol-HTTP-custom`, qui permet de configurer automatiquement plusieurs services utiles à la supervision d'un site web.

Parmi les templates de services associés, nous retrouvons notamment :

- `App-Protocol-HTTP-Response-Time-custom` : pour mesurer le temps de réponse HTTP d'une page web,
- des services personnalisés permettant de vérifier un contenu attendu (HTML, JSON ou SOAP),
- et bien entendu, la possibilité d'ajouter une vérification de la date d'expiration du certificat SSL.

En combinant ces services, nous allons mettre en place une supervision complète d'un site web, incluant à la fois la disponibilité (code HTTP), la performance (temps de réponse) et la sécurité (certificat HTTPS). Nous partons du principe que le serveur Centreon est déjà opérationnel.

Sans oublier nos tutoriels Centreon déjà disponibles :

- Centreon : installation de votre serveur de supervision sous Linux
- Sécurisation Centreon : protection des utilisateurs, SELinux, pare-feu, etc.
- Sécurisation Centreon : comment configurer l'accès HTTPS pour l'interface Web ?
- Centreon : comment superviser des serveurs Linux avec SNMPv3 ?
- Centreon : comment superviser Windows Server ?
- Centreon : comment importer des hôtes via un fichier CSV et l'API CLAPI ?
- Centreon : comment superviser votre firewall pfSense

## II. Le connecteur HTTP Server de Centreon

Afin de pouvoir réaliser nos vérifications sur notre site web, nous allons devoir avoir un site web fonctionnel avec un certificat associé. Dans notre cas, nous créerons un serveur web pour la démonstration. Si vous avez besoin d'aide pour monter un serveur Web, retrouvez nos tutoriels : Tutoriels sur les serveurs Web

Désormais, nous allons utiliser le template de service HTTP Server proposé par Centreon, ce template est disponible dans **Configuration -> Connectors -> Monitoring Connectors**. Effectuez la recherche avec le mot clé HTTP Server et installez le connecteur.

![Installation du connecteur HTTP Server dans Centreon]( /images/centreon_tls/1.png)

Une fois le connecteur installé, nous allons créer un nouvel hôte dans Centreon, qui représentera notre site web à surveiller. Voici la configuration utilisée dans notre exemple :

- **Nom de l'hôte** : HTTP_SERVER
- **Adresse IP** : 10.30.111.20 (adresse de notre serveur Apache)
- **Template** : App-Protocol-HTTP-custom

![Création de l'hôte HTTP Server dans Centreon]( /images/centreon_tls/2.png)

> Pour conserver le nouveau format de métrique, incluez `--use-new-perfdata` dans la macro de service EXTRAOPTIONS.

Dans notre cas, voici le résultat attendu :

![Résultats de la supervision HTTP dans Centreon]( /images/centreon_tls/3.png)

> **À noter** : il est aussi possible de faire la vérification avec le protocole HTTPS sur le port 443 avec le connecteur en utilisant la configuration ci-dessous :

![Configuration HTTPS dans Centreon]( /images/centreon_tls/4.png)

Pour améliorer la surveillance de notre site web, il est possible d'utiliser plusieurs seuils pour contrôler à la fois le code de réponse HTTP et le temps de réponse de la page. Les options `--warning-status` et `--critical-status` permettent de définir des seuils pour déclencher une alerte si le code de réponse HTTP est différent de celui attendu (par exemple, pour signaler un code 4xx ou 5xx).

On retrouve aussi les options, `--warning-time` et `--critical-time` permettant de définir une durée en secondes pour le temps de réponse du site : si la page met trop de temps à charger, Centreon peut générer une alerte de type warning ou critical en fonction du seuil dépassé.

> **Note** : Nous pouvons fixer les warning-time et critical-time en fonction de nos attentes, nous pouvons dans notre exemple utiliser `--warning-time=2` et le `--critical-time=5`. Ce temps est défini en secondes en fonction des exigences de votre site.

## III. Surveiller les certificats SSL avec Centreon

En plus de surveiller la disponibilité de notre site web et son temps de réponse, nous devons nous assurer que son certificat TLS / SSL ne soit pas expiré ou sur le point de l'être. Un certificat expiré peut bloquer l'accès sécurisé au site, engendrer des alertes de sécurité côté navigateur et surtout provoquer une rupture de service pour les utilisateurs ou clients.

Avec Centreon, nous pouvons facilement superviser le nombre de jours restants avant expiration du certificat HTTPS grâce au plugin inclus dans le connecteur HTTP, ou via une commande personnalisée.

Afin de pouvoir effectuer nos vérifications, nous devons installer le connecteur x509 Certificate dans **Configuration -> Connectors -> Monitoring Connectors**. Effectuez la recherche avec le mot clé X509 et installez le connecteur adéquat.

![Installation du connecteur x509 Certificate dans Centreon]( /images/centreon_tls/5.png)

Une fois le connecteur installé, nous allons ajouter la template à notre hôte :

![Ajout du template x509 Certificate dans Centreon]( /images/centreon_tls/6.png)

Nous allons aussi ajouter deux nouvelles options pour le contrôle de l'expiration des certificats SSL/TLS.

- **CRITICALSTATUS** : configuré à `%{expiration} < 7` pour déclencher une alerte CRITICAL si la date d'expiration est inférieure à 7 jours.
- **WARNINGSTATUS** : ici configuré à `%{expiration} < 14` pour générer une alerte WARNING si le certificat expire dans moins de 14 jours.

> **Remarque** : il est indispensable d'exporter la configuration après chaque modification (ajout, suppression ou mise à jour d'un hôte, d'un service ou d'un poller). Sans cette étape, les changements ne seront pas pris en compte par le moteur de supervision, ce qui pourrait entraîner un décalage entre ce qui est configuré et ce qui est réellement surveillé.

Le résultat attendu est le suivant :

![Résultats de la supervision TLS dans Centreon]( /images/centreon_tls/7.png)

## IV. Conclusion

Grâce au connecteur HTTP Server et au plugin x509 de Centreon, nous avons pu mettre en place une supervision complète d'un site web. Cette supervision inclut la vérification du code de retour HTTP, du temps de réponse, ainsi que de l'état du certificat SSL. Ces éléments sont essentiels pour garantir à la fois la disponibilité, la performance et la sécurité de vos services web.

Dans les prochains articles, nous allons voir comment créer vos premiers graphiques, pour avoir une meilleure visibilité sur l'état globale de l'infrastructure.

Si vous avez des questions, vous pouvez commenter cet article.

[Accéder à la documentation de Centreon](https://docs.centreon.com/)
